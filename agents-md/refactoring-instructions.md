Refactorizá esta función aplicando:
 1. Early returns para reducir nesting
 2. Extrae validaciones a funciones separadas
 3. Usa métodos de array modernos (reduce en vez de for)
 4. Nombres de variables descriptivos
 5. TypeScript con tipos explícitos
 6. Maneja edge cases (array vacío, valores negativos, null)

